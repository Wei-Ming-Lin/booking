

> **Machine Booking System v2.0**  
> åŸºæ–¼ Next.js 14 å’Œ Flask çš„ç¾ä»£åŒ–è¨­å‚™é ç´„å¹³å°

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Next.js](https://img.shields.io/badge/Next.js-14.1.0-black)](https://nextjs.org/)
[![Flask](https://img.shields.io/badge/Flask-Latest-blue)](https://flask.palletsprojects.com/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue)](https://www.postgresql.org/)
[![Docker](https://img.shields.io/badge/Docker-Compose-blue)](https://docs.docker.com/compose/)

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### ğŸ‘¤ ç”¨æˆ¶ç«¯åŠŸèƒ½
- **ğŸ” Google OAuth èªè­‰** - æ•´åˆ NextAuth.jsï¼Œå®‰å…¨ä¾¿æ·ç™»å…¥
- **ğŸ“… æ™ºèƒ½é ç´„ç³»çµ±** - 4å°æ™‚æ™‚æ®µåˆ¶ï¼Œå³æ™‚è¡çªæª¢æ¸¬
- **â° å°åŒ—æ™‚å€æ”¯æ´** - å®Œæ•´çš„ `Asia/Taipei` æ™‚å€è™•ç†
- **ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆ** - æ”¯æ´æ‰‹æ©Ÿã€å¹³æ¿ã€æ¡Œé¢ç­‰å¤šç¨®è¨­å‚™
- **ğŸ‘¤ å€‹äººè³‡æ–™ç®¡ç†** - æŸ¥çœ‹é ç´„è¨˜éŒ„ã€ä½¿ç”¨çµ±è¨ˆã€å€‹äººè¨­å®š
- **ğŸ”” å³æ™‚é€šçŸ¥** - ç³»çµ±å…¬å‘Šã€ç¶­è­·é€šçŸ¥ã€é ç´„æé†’

### ğŸ› ï¸ ç®¡ç†å“¡åŠŸèƒ½
- **ğŸ­ æ©Ÿå™¨ç®¡ç†** - æ–°å¢ã€ç·¨è¼¯ã€åœç”¨è¨­å‚™ï¼Œæ”¯æ´ç‹€æ…‹ç®¡ç†
- **ğŸ“Š é ç´„ç®¡ç†** - å…¨åŸŸé ç´„æŸ¥çœ‹ã€å¼·åˆ¶å–æ¶ˆã€ä½¿ç”¨åˆ†æ
- **ğŸ‘¥ ç”¨æˆ¶ç®¡ç†** - è§’è‰²æ¬Šé™æ§åˆ¶ï¼ˆuser/manager/adminï¼‰
- **ğŸ”’ é™åˆ¶è¦å‰‡å¼•æ“** - å¹´ç´šé™åˆ¶ã€ä½¿ç”¨é »ç‡æ§åˆ¶ã€å†·å»æœŸè¨­å®š
- **ğŸ“¢ é€šçŸ¥ç³»çµ±** - å¤šç´šåˆ¥å…¬å‘Šç™¼å¸ƒï¼ˆä½/ä¸­/é«˜å„ªå…ˆç´šï¼‰
- **ğŸ“… æ—¥æ›†ç¸½è¦½** - æœˆæ›†æª¢è¦–ï¼Œæ”¯æ´æ©Ÿå™¨ç¯©é¸å’ŒåŒ¿ååŒ–é¡¯ç¤º
- **ğŸ” å¯©è¨ˆæ—¥èªŒ** - å®Œæ•´çš„æ“ä½œè¨˜éŒ„å’Œæ•¸æ“šè®Šæ›´è¿½è¹¤

### ğŸ”’ éš±ç§èˆ‡å®‰å…¨
- **ğŸ­ åŒ¿ååŒ–é¡¯ç¤º** - é ç´„è€…å§“åæ ¼å¼åŒ–ç‚ºã€Œå¼µOç”±ã€å½¢å¼
- **ğŸ›¡ï¸ é›™é‡APIæ¶æ§‹** - é ç´„ç•Œé¢èˆ‡ç®¡ç†ç•Œé¢è³‡æ–™åˆ†é›¢
- **ğŸ” æ¬Šé™åˆ†ç´š** - åŸºæ–¼è§’è‰²çš„å­˜å–æ§åˆ¶ï¼ˆRBACï¼‰
- **ğŸ“ æ“ä½œå¯©è¨ˆ** - æ‰€æœ‰é—œéµæ“ä½œè¨˜éŒ„è‡³ç³»çµ±æ—¥èªŒ

### âš¡ æŠ€è¡“ç‰¹è‰²
- **ğŸš€ é«˜æ€§èƒ½** - è³‡æ–™åº«ç´¢å¼•å„ªåŒ–ã€æŸ¥è©¢æ€§èƒ½èª¿æ ¡
- **ğŸ”„ å³æ™‚åŒæ­¥** - é ç´„ç‹€æ…‹å³æ™‚æ›´æ–°ï¼Œé¿å…è¡çª
- **ğŸ—„ï¸ è³‡æ–™å®Œæ•´æ€§** - PostgreSQL è§¸ç™¼å™¨ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§
- **ğŸ§¼ è‡ªå‹•æ¸…ç†** - éæœŸè³‡æ–™è‡ªå‹•æ­¸æª”ï¼Œç³»çµ±æ•ˆèƒ½æœ€ä½³åŒ–
- **ğŸ“ˆ ç›£æ§çµ±è¨ˆ** - å…§å»ºç³»çµ±çµ±è¨ˆè¦–åœ–å’Œåˆ†æå‡½æ•¸

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹

### ğŸ¨ å‰ç«¯æŠ€è¡“æ£§
```yaml
Framework: Next.js 14.1.0 (App Router)
Language: TypeScript 5.3.3
Styling: Tailwind CSS 3.4.1 + è‡ªå®šç¾©ä¸»é¡Œ
UI Components: 
  - Headless UI (@headlessui/react)
  - Heroicons (@heroicons/react)
  - Lucide React (icons)
State Management: Zustand 5.0.5
Authentication: NextAuth.js 4.24.5
Time Handling: 
  - date-fns 4.1.0
  - date-fns-tz 3.2.0
Validation: Zod 3.25.36
HTTP Client: Fetch API (åŸç”Ÿ)
Development: ESLint + TypeScript
```

### âš™ï¸ å¾Œç«¯æŠ€è¡“æ£§
```yaml
Framework: Flask (Python 3.11)
Database: PostgreSQL 15
ORM: åŸç”Ÿ SQL æŸ¥è©¢ (psycopg2-binary)
Authentication: Google OAuth 2.0
Time Zone: pytz (Asia/Taipei)
API Design: RESTful API
CORS: Flask-CORS
Security: SQL æ³¨å…¥é˜²è­·ã€CSRF ä¿è­·
```

### ğŸ—„ï¸ è³‡æ–™åº«è¨­è¨ˆ
```yaml
Tables: 7 æ ¸å¿ƒè³‡æ–™è¡¨
Views: 3 ç®¡ç†è¦–åœ–
Functions: 5 è‡ªå®šç¾©å‡½æ•¸  
Triggers: 8 è‡ªå‹•åŒ–è§¸ç™¼å™¨
Indexes: 20+ æ€§èƒ½å„ªåŒ–ç´¢å¼•
Features:
  - è‡ªå‹•æ™‚é–“æˆ³æ›´æ–°
  - é ç´„è¡çªæª¢æ¸¬
  - è³‡æ–™è®Šæ›´å¯©è¨ˆ
  - è‡ªå‹•æ¸…ç†æ©Ÿåˆ¶
```

### ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²
```yaml
Orchestration: Docker Compose
Services:
  - Frontend: Next.js (Port 3000)
  - Backend: Flask (Port 5000)  
  - Database: PostgreSQL 15 (Port 5432)
Networks: è‡ªå®šç¾©ç¶²è·¯éš”é›¢
Volumes: 
  - è³‡æ–™åº«æŒä¹…åŒ–å„²å­˜
  - æ‡‰ç”¨ç¨‹å¼ä»£ç¢¼æ›è¼‰
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```bash
ğŸ“¦ booking/
â”œâ”€â”€ ğŸ¨ booking_fromtend/                    # Next.js 14 å‰ç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ ğŸ“‚ src/                             # æ‡‰ç”¨ç¨‹å¼æºç¢¼
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ app/                         # App Router æ¶æ§‹
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ” admin/                   # ç®¡ç†å“¡æ§åˆ¶å°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                # ç®¡ç†å„€è¡¨æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸŒ api/                     # Next.js API è·¯ç”±
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ analytics/              # åˆ†æ API
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth/[...nextauth]/     # NextAuth.js èªè­‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ bookings/               # é ç´„ç›¸é—œ API
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“… bookings/                # é ç´„æ—¥æ›†é é¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                # æ—¥æ›†æª¢è¦–çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ”‘ login/                   # ä½¿ç”¨è€…ç™»å…¥
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ­ machine/[id]/            # å‹•æ…‹æ©Ÿå™¨é é¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx                # æ©Ÿå™¨è©³æƒ…èˆ‡é ç´„
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ calendar.css            # æ—¥æ›†æ¨£å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ‘¤ profile/                 # ç”¨æˆ¶å€‹äººè³‡æ–™
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx                  # æ ¹ä½ˆå±€çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx                    # é¦–é çµ„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ globals.css                 # å…¨åŸŸæ¨£å¼
â”‚   â”‚   â”œâ”€â”€ ğŸ§© components/                  # React å¯é‡ç”¨çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ BookingConfirmation.tsx     # é ç´„ç¢ºèªå°è©±æ¡†
â”‚   â”‚   â”‚   â”œâ”€â”€ CancelBookingConfirmation.tsx # å–æ¶ˆé ç´„ç¢ºèª
â”‚   â”‚   â”‚   â”œâ”€â”€ MachineCard.tsx             # æ©Ÿå™¨å¡ç‰‡çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Navbar.tsx                  # å°èˆªåˆ—çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ TimeSlotSelector.tsx        # æ™‚æ®µé¸æ“‡å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ SystemNotifications.tsx     # ç³»çµ±é€šçŸ¥çµ„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ...                         # å…¶ä»–UIçµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸª hooks/                       # è‡ªå®šç¾© React Hooks
â”‚   â”‚   â”‚   â””â”€â”€ useNotifications.ts         # é€šçŸ¥ç³»çµ±Hook
â”‚   â”‚   â”œâ”€â”€ ğŸ“š lib/                         # å·¥å…·å‡½æ•¸åº«
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts                     # èªè­‰ç›¸é—œå·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ timezone.ts                 # æ™‚å€è™•ç†å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ userRestrictions.ts         # ç”¨æˆ¶é™åˆ¶é‚è¼¯
â”‚   â”‚   â”‚   â””â”€â”€ utils.ts                    # é€šç”¨å·¥å…·å‡½æ•¸
â”‚   â”‚   â”œâ”€â”€ ğŸŒ services/                    # API æœå‹™å±¤
â”‚   â”‚   â”‚   â””â”€â”€ api.ts                      # API å®¢æˆ¶ç«¯å°è£
â”‚   â”‚   â”œâ”€â”€ ğŸ—„ï¸ store/                       # Zustand ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ machineStore.ts             # æ©Ÿå™¨ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ userStore.ts                # ç”¨æˆ¶ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â””â”€â”€ ğŸ“ types/                       # TypeScript é¡å‹å®šç¾©
â”‚   â”‚       â”œâ”€â”€ index.ts                    # ä¸»è¦é¡å‹å®šç¾©
â”‚   â”‚       â””â”€â”€ next-auth.d.ts              # NextAuth é¡å‹æ“´å±•
â”‚   â”œâ”€â”€ ğŸ“ public/                          # éœæ…‹è³‡æº
â”‚   â”‚   â”œâ”€â”€ favicon.ico                     # ç¶²ç«™åœ–æ¨™
â”‚   â”‚   â””â”€â”€ site.webmanifest                # PWA é…ç½®
â”‚   â”œâ”€â”€ ğŸ“‹ package.json                     # Node.js å°ˆæ¡ˆé…ç½®
â”‚   â”œâ”€â”€ ğŸ“‹ tsconfig.json                    # TypeScript ç·¨è­¯é…ç½®
â”‚   â”œâ”€â”€ ğŸ¨ tailwind.config.js               # Tailwind CSS è‡ªå®šç¾©é…ç½®
â”‚   â”œâ”€â”€ ğŸ³ Dockerfile                       # å‰ç«¯å®¹å™¨åŒ–é…ç½®
â”‚   â”œâ”€â”€ ğŸ³ docker-compose.yml               # å‰ç«¯æœå‹™ç·¨æ’
â”‚   â”œâ”€â”€ âš™ï¸ next.config.js                   # Next.js æ‡‰ç”¨é…ç½®
â”‚   â””â”€â”€ ğŸ” env.example                      # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ ğŸš€ booking_backend/                     # Flask å¾Œç«¯ API
â”‚   â”œâ”€â”€ ğŸ“„ app.py                           # Flask æ‡‰ç”¨ä¸»ç¨‹å¼ (4357 è¡Œ)
â”‚   â”œâ”€â”€ ğŸ—„ï¸ init.sql                         # PostgreSQL åˆå§‹åŒ–è…³æœ¬ (584 è¡Œ)
â”‚   â”‚                                       # åŒ…å«ï¼šè³‡æ–™è¡¨ã€è§¸ç™¼å™¨ã€ç´¢å¼•ã€è¦–åœ–ã€å‡½æ•¸
â”‚   â”œâ”€â”€ ğŸ“‹ requirements.txt                 # Python ä¾è³´æ¸…å–®
â”‚   â”‚                                       # flask, flask-cors, psycopg2-binary, pytz
â”‚   â”œâ”€â”€ ğŸ³ Dockerfile                       # å¾Œç«¯å®¹å™¨åŒ–é…ç½®
â”‚   â”œâ”€â”€ ğŸ³ docker-compose.yml               # å®Œæ•´ç³»çµ±ç·¨æ’ï¼ˆå«è³‡æ–™åº«ï¼‰
â”‚   â”œâ”€â”€ ğŸ” .env_example                     # å¾Œç«¯ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”‚   â””â”€â”€ ğŸ“ pgdata/                          # PostgreSQL è³‡æ–™æŒä¹…åŒ–ç›®éŒ„
â”œâ”€â”€ ğŸ“– README.md                            # å°ˆæ¡ˆæ–‡æª”ï¼ˆæœ¬æª”æ¡ˆï¼‰
â””â”€â”€ ğŸ”’ .gitignore                           # Git å¿½ç•¥è¦å‰‡é…ç½®
```

## ğŸ’» ç³»çµ±éœ€æ±‚

### ğŸ³ Docker éƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰
```yaml
ç³»çµ±éœ€æ±‚:
  - Docker Engine: 20.10.0+
  - Docker Compose: 2.0.0+
  - ç³»çµ±è¨˜æ†¶é«”: 4GB+
  - å¯ç”¨ç£ç¢Ÿ: 10GB+
  - ä½œæ¥­ç³»çµ±: Linux/macOS/Windows

æ€§èƒ½å»ºè­°:
  - CPU: 2æ ¸å¿ƒä»¥ä¸Š
  - RAM: 8GB+ (æ¨è–¦)
  - ç£ç¢Ÿ: SSD (æå‡è³‡æ–™åº«æ€§èƒ½)
  - ç¶²è·¯: ç©©å®šçš„ç¶²éš›ç¶²è·¯é€£ç·š
```

### ğŸ› ï¸ æœ¬åœ°é–‹ç™¼ï¼ˆå¯é¸ï¼‰
```yaml
å‰ç«¯é–‹ç™¼:
  - Node.js: 18.0+ (æ¨è–¦ 18.19.0)
  - npm: 9.0+ æˆ– yarn: 1.22+
  - TypeScript: 5.3+

å¾Œç«¯é–‹ç™¼:
  - Python: 3.11+ 
  - pip: 23.0+
  - PostgreSQL: 15+ (æ¨è–¦)

é–‹ç™¼å·¥å…·:
  - VS Code + ç›¸é—œæ’ä»¶
  - Git: 2.34+
  - Chrome/Firefox (é–‹ç™¼è€…å·¥å…·)
```

### ğŸ”§ ç¬¬ä¸‰æ–¹æœå‹™
```yaml
å¿…è¦æœå‹™:
  - Google OAuth 2.0 (èªè­‰)
    - Client ID & Secret
    - æˆæ¬Šå›èª¿ URL è¨­å®š

å¯é¸æœå‹™:
  - ç›£æ§ç³»çµ± (Prometheus/Grafana)
  - æ—¥èªŒæ”¶é›† (ELK Stack)
  - å‚™ä»½æœå‹™ (å®šæœŸè³‡æ–™åº«å‚™ä»½)
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ğŸ“¥ å°ˆæ¡ˆä¸‹è¼‰

```bash
# å…‹éš†å„²å­˜åº«
git clone <repository-url>
cd booking

# æª¢æŸ¥å°ˆæ¡ˆçµæ§‹
ls -la
```

### 2. ğŸ”§ ç’°å¢ƒé…ç½®

#### ğŸ” å¾Œç«¯ç’°å¢ƒè®Šæ•¸
```bash
cd booking_backend

# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp .env_example .env

# ç·¨è¼¯ç’°å¢ƒè®Šæ•¸ï¼ˆå¿…é ˆè¨­å®šï¼‰
nano .env
```

#### ğŸ¨ å‰ç«¯ç’°å¢ƒè®Šæ•¸
```bash
cd booking_fromtend

# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp env.example .env.local

# ç·¨è¼¯ç’°å¢ƒè®Šæ•¸ï¼ˆå¿…é ˆè¨­å®šï¼‰
nano .env.local
```

> âš ï¸ **é‡è¦æé†’**ï¼šè«‹å‹™å¿…è¨­å®šæ‰€æœ‰å¿…è¦çš„ç’°å¢ƒè®Šæ•¸ï¼Œç‰¹åˆ¥æ˜¯è³‡æ–™åº«å¯†ç¢¼å’Œ Google OAuth é‡‘é‘°

### 3. ç’°å¢ƒè®Šæ•¸è©³ç´°é…ç½®

#### å‰ç«¯é…ç½® (`booking_fromtend/.env`)
```env
# Next.js é…ç½®
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-nextauth-secret-here

# Google OAuth é…ç½®
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# API é…ç½®
API_URL=http://localhost:5000
```

#### å¾Œç«¯é…ç½® (`booking_backend/.env`)
```env
# PostgreSQL å®¹å™¨è³‡è¨Š
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_strong_password
POSTGRES_DB=booking_system

# Flask æ‡‰ç”¨è³‡æ–™åº«é€£æ¥
DB_NAME=booking_system
DB_USER=postgres
DB_PASSWORD=your_strong_password
DB_HOST=db  # Docker Compose æœå‹™åç¨±
DB_PORT=5432
```

### 4. ğŸš€ æœå‹™éƒ¨ç½²

#### ğŸ¯ æ–¹å¼ä¸€ï¼šå®Œæ•´å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰
```bash
# ğŸš€ å•Ÿå‹•å¾Œç«¯æœå‹™ï¼ˆåŒ…å«è³‡æ–™åº«ï¼‰
cd booking_backend
docker-compose up -d

# ğŸ“± å•Ÿå‹•å‰ç«¯æœå‹™
cd ../booking_fromtend  
docker-compose up -d

# ğŸ” æª¢æŸ¥æœå‹™ç‹€æ…‹
docker-compose ps
```

#### ğŸ› ï¸ æ–¹å¼äºŒï¼šæ··åˆéƒ¨ç½²ï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
```bash
# ğŸ—„ï¸ åƒ…å•Ÿå‹•å¾Œç«¯å’Œè³‡æ–™åº«
cd booking_backend
docker-compose up -d

# ğŸ’» å‰ç«¯é–‹ç™¼æ¨¡å¼
cd ../booking_fromtend
npm install
npm run dev
```

#### ğŸ“Š æœå‹™ç›£æ§
```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ç‹€æ…‹
docker ps

# æŸ¥çœ‹æœå‹™æ—¥èªŒ
cd booking_backend && docker-compose logs -f
cd booking_fromtend && docker-compose logs -f

# è³‡æºä½¿ç”¨ç›£æ§
docker stats
```

### 5. ğŸŒ è¨ªå•ç³»çµ±

éƒ¨ç½²å®Œæˆå¾Œï¼Œç³»çµ±å°‡åœ¨ä»¥ä¸‹åœ°å€é‹è¡Œï¼š

| æœå‹™ | URL | æè¿° |
|------|-----|------|
| ğŸ¨ **å‰ç«¯æ‡‰ç”¨** | http://localhost:3000 | ç”¨æˆ¶ç•Œé¢ |
| ğŸ”§ **å¾Œç«¯ API** | http://localhost:5000 | RESTful API |
| ğŸ—„ï¸ **è³‡æ–™åº«** | localhost:5432 | PostgreSQL |

> ğŸ‰ **é¦–æ¬¡è¨ªå•**ï¼šè«‹å…ˆåˆ° http://localhost:3000/login é€²è¡Œ Google OAuth ç™»å…¥

## ğŸ“– ç³»çµ±åŠŸèƒ½è©³è¿°

### ğŸ¯ é ç´„ç®¡ç†ç³»çµ±
```yaml
æ™‚æ®µåˆ†å‰²:
  - æ¨¡å¼: 4å°æ™‚æ™‚æ®µåˆ¶
  - åˆ†å‰²: 6å€‹æ™‚æ®µ/å¤© (00:00-04:00, 04:00-08:00, 08:00-12:00, 12:00-16:00, 16:00-20:00, 20:00-24:00)
  - é ç´„å–®ä½: 1å€‹æ™‚æ®µ/æ¬¡
  - å–æ¶ˆæ”¿ç­–: éš¨æ™‚å¯å–æ¶ˆ

é ç´„ç‹€æ…‹:
  - active: æœ‰æ•ˆé ç´„
  - cancelled: ç”¨æˆ¶å–æ¶ˆ
  - completed: å·²å®Œæˆä½¿ç”¨
  - no_show: æœªå‡ºå¸­ä½¿ç”¨

è¡çªè™•ç†:
  - å³æ™‚è¡çªæª¢æ¸¬
  - è‡ªå‹•é˜²é‡è¤‡é ç´„
  - è³‡æ–™åº«å±¤ç´šç´„æŸ
```

### ğŸ›¡ï¸ é›™é‡APIæ¶æ§‹
```yaml
é ç´„API (/bookings/machine/{id}):
  ç”¨é€”: ç”¨æˆ¶é ç´„ç•Œé¢
  è³‡æ–™: åƒ…æ™‚æ®µå¯ç”¨æ€§
  éš±ç§: å®Œå…¨éš±è—ç”¨æˆ¶èº«ä»½
  å›å‚³: user_display_name = ""

æ—¥æ›†API (/bookings/calendar-view): 
  ç”¨é€”: ç®¡ç†æ—¥æ›†æª¢è¦–
  è³‡æ–™: åŒ¿ååŒ–ç”¨æˆ¶å§“å
  éš±ç§: æ ¼å¼åŒ–ç‚ºã€Œå¼µOç”±ã€
  å›å‚³: user_email = "hidden"
```

### ğŸ“Š API ç«¯é»ç¸½è¦½
| ç«¯é» | æ–¹æ³• | åŠŸèƒ½ | èªè­‰ |
|------|------|------|------|
| `/machines` | GET | æ©Ÿå™¨æ¸…å–® | âœ… |
| `/users/profile` | GET | ç”¨æˆ¶è³‡æ–™ | âœ… |
| `/bookings/machine/{id}` | GET | æ©Ÿå™¨é ç´„ç‹€æ³ | âœ… |
| `/bookings/calendar-view` | GET | æ—¥æ›†æª¢è¦– | âœ… |
| `/bookings` | POST | å»ºç«‹é ç´„ | âœ… |
| `/bookings/{id}` | DELETE | å–æ¶ˆé ç´„ | âœ… |
| `/notifications` | GET | ç³»çµ±é€šçŸ¥ | âœ… |
| `/analytics/*` | GET | ä½¿ç”¨åˆ†æ | ğŸ” Admin |

### ğŸ”’ é™åˆ¶è¦å‰‡å¼•æ“
```yaml
å¹´ä»½é™åˆ¶ (year_limit):
  è¦å‰‡: "å…è¨±å¹´ä»½æ¸…å–®"
  ç¯„ä¾‹: "112,113,114" (æ°‘åœ‹å¹´)
  
ä½¿ç”¨é »ç‡ (usage_limit):
  è¦å‰‡: "æ¬¡æ•¸,å†·å»æ™‚æ•¸"  
  ç¯„ä¾‹: "2,24" (24å°æ™‚å…§æœ€å¤š2æ¬¡)

éƒµç®±é™åˆ¶ (email_pattern):
  è¦å‰‡: æ­£è¦è¡¨é”å¼
  ç¯„ä¾‹: "@ntub\.edu\.tw$" (åƒ…é™å­¸æ ¡ä¿¡ç®±)

æ™‚é–“é™åˆ¶ (time_limit):
  è¦å‰‡: ç‰¹å®šæ™‚é–“ç¯„åœ
  ç¯„ä¾‹: é€±æœ«é™åˆ¶ã€è€ƒè©¦æœŸé–“é™åˆ¶
```

### ğŸ“¢ é€šçŸ¥ç³»çµ±
```yaml
å„ªå…ˆç´šåˆ†é¡:
  - ä½: ä¸€èˆ¬å…¬å‘Š
  - ä¸­: é‡è¦é€šçŸ¥  
  - é«˜: ç·Šæ€¥è¨Šæ¯

é€šçŸ¥åˆ†é¡:
  - general: ä¸€èˆ¬å…¬å‘Š
  - maintenance: ç¶­ä¿®é€šçŸ¥
  - emergency: ç·Šæ€¥ç‹€æ³
  - announcement: å®˜æ–¹å…¬å‘Š

æ™‚é–“æ§åˆ¶:
  - ç«‹å³ç”Ÿæ•ˆ
  - å®šæ™‚ç™¼å¸ƒ
  - è‡ªå‹•éæœŸ
```

## ğŸ”§ ç³»çµ±ç¶­è­·æŒ‡å—

### ğŸ—„ï¸ è³‡æ–™åº«ç¶­è­·
```sql
-- â° æ¸…ç†éæœŸé ç´„ï¼ˆè‡ªå‹•æ¨™è¨˜ç‹€æ…‹ï¼‰
SELECT cleanup_expired_bookings();

-- ğŸ§¹ æ¸…ç†èˆŠç³»çµ±æ—¥èªŒï¼ˆé è¨­ä¿ç•™90å¤©ï¼‰
SELECT cleanup_old_logs(90);

-- ğŸ“Š æ›´æ–°è³‡æ–™åº«çµ±è¨ˆè³‡è¨Šï¼ˆæå‡æŸ¥è©¢æ•ˆèƒ½ï¼‰
ANALYZE;

-- ğŸ” æª¢æŸ¥è³‡æ–™åº«å¥åº·ç‹€æ³
SELECT * FROM get_system_stats();

-- ğŸ“ˆ æŸ¥çœ‹æ©Ÿå™¨ä½¿ç”¨çµ±è¨ˆ
SELECT * FROM machine_usage_stats;

-- ğŸ“¢ æª¢æŸ¥æ´»èºé€šçŸ¥
SELECT * FROM active_notifications;
```

### ğŸ“Š ç³»çµ±ç›£æ§
```bash
# ğŸ³ Docker å®¹å™¨ç›£æ§
docker stats

# ğŸ“ æŸ¥çœ‹æ‡‰ç”¨æ—¥èªŒ
docker-compose logs -f --tail=100

# ğŸ—„ï¸ è³‡æ–™åº«é€£ç·šæª¢æŸ¥  
docker-compose exec db psql -U postgres -d booking_system -c "SELECT version();"

# ğŸ’¾ æª¢æŸ¥ç£ç¢Ÿä½¿ç”¨é‡
df -h

# ğŸ” æª¢æŸ¥ç³»çµ±è³‡æº
htop
```

### ğŸ› ï¸ æ•…éšœæ’é™¤
```yaml
å¸¸è¦‹å•é¡Œ:
  1. å®¹å™¨ç„¡æ³•å•Ÿå‹•:
     - æª¢æŸ¥: docker-compose ps
     - è§£æ±º: docker-compose down && docker-compose up -d
     
  2. è³‡æ–™åº«é€£ç·šå¤±æ•—:
     - æª¢æŸ¥: ç’°å¢ƒè®Šæ•¸è¨­å®š
     - è§£æ±º: ç¢ºèª .env æª”æ¡ˆæ­£ç¢ºæ€§
     
  3. OAuth èªè­‰å¤±æ•—:
     - æª¢æŸ¥: Google Console è¨­å®š
     - è§£æ±º: ç¢ºèªå›èª¿ URL æ­£ç¢º
     
  4. å‰ç«¯ç„¡æ³•å­˜å–å¾Œç«¯:
     - æª¢æŸ¥: API_URL ç’°å¢ƒè®Šæ•¸
     - è§£æ±º: ç¢ºèªæœå‹™ç¶²è·¯äº’é€š
```

### ğŸ’¾ å‚™ä»½èˆ‡é‚„åŸ
```bash
# ğŸ“¦ è³‡æ–™åº«å‚™ä»½
cd booking_backend
docker-compose exec db pg_dump -U postgres booking_system > backup_$(date +%Y%m%d).sql

# ğŸ”„ é‚„åŸè³‡æ–™åº«
docker-compose exec -T db psql -U postgres booking_system < backup_20241201.sql

# ğŸ“ å®Œæ•´ç³»çµ±å‚™ä»½ï¼ˆå«é…ç½®æª”æ¡ˆï¼‰
tar -czf system_backup_$(date +%Y%m%d).tar.gz booking/

# ğŸ”’ åŠ å¯†å‚™ä»½ï¼ˆå»ºè­°ç”¨æ–¼æ­£å¼ç’°å¢ƒï¼‰
gpg -c backup_$(date +%Y%m%d).sql
```

### âš¡ æ•ˆèƒ½å„ªåŒ–
```yaml
è³‡æ–™åº«å„ªåŒ–:
  - å®šæœŸåŸ·è¡Œ VACUUM ANALYZE
  - ç›£æ§æ…¢æŸ¥è©¢æ—¥èªŒ
  - æª¢æŸ¥ç´¢å¼•ä½¿ç”¨æ•ˆç‡
  
æ‡‰ç”¨ç¨‹å¼å„ªåŒ–:
  - å®šæœŸæ¸…ç†å®¹å™¨æ˜ åƒ
  - ç›£æ§è¨˜æ†¶é«”ä½¿ç”¨é‡
  - èª¿æ•´ Docker è³‡æºé™åˆ¶
  
ç¶²è·¯å„ªåŒ–:
  - ä½¿ç”¨ CDNï¼ˆå¦‚éœ€è¦ï¼‰
  - å•Ÿç”¨ gzip å£“ç¸®
  - é…ç½®é©ç•¶çš„å¿«å–ç­–ç•¥
```

## ğŸ” å®‰å…¨èˆ‡æ¬Šé™

### ğŸ‘¥ ç”¨æˆ¶è§’è‰²æ¶æ§‹
```yaml
è§’è‰²æ¬Šé™åˆ†ç´š:
  user (ä¸€èˆ¬ç”¨æˆ¶):
    - æŸ¥çœ‹æ©Ÿå™¨æ¸…å–®
    - é ç´„å¯ç”¨æ™‚æ®µ
    - ç®¡ç†å€‹äººé ç´„
    - æŸ¥çœ‹å€‹äººè³‡æ–™
    
  manager (ç®¡ç†å“¡):
    - åŒ…å« user æ¬Šé™
    - ç®¡ç†æ©Ÿå™¨ç‹€æ…‹
    - æŸ¥çœ‹æ‰€æœ‰é ç´„
    - ç™¼å¸ƒé€šçŸ¥å…¬å‘Š
    
  admin (è¶…ç´šç®¡ç†å“¡):
    - åŒ…å« manager æ¬Šé™
    - ç”¨æˆ¶æ¬Šé™ç®¡ç†
    - ç³»çµ±è¨­å®šä¿®æ”¹
    - è³‡æ–™åº«ç¶­è­·
```

### ğŸ”‘ Google OAuth è¨­å®š
```yaml
è¨­å®šæ­¥é©Ÿ:
  1. Google Cloud Console:
     - å»ºç«‹æ–°å°ˆæ¡ˆ
     - å•Ÿç”¨ Google+ API
     - å»ºç«‹ OAuth 2.0 æ†‘è­‰
     
  2. æˆæ¬Šè¨­å®š:
     - é–‹ç™¼ç’°å¢ƒ: http://localhost:3000/api/auth/callback/google
     - æ­£å¼ç’°å¢ƒ: https://yourdomain.com/api/auth/callback/google
     
  3. ç’°å¢ƒè®Šæ•¸:
     - GOOGLE_CLIENT_ID: ä½ çš„å®¢æˆ¶ç«¯ID
     - GOOGLE_CLIENT_SECRET: ä½ çš„å®¢æˆ¶ç«¯å¯†é‘°
     - NEXTAUTH_SECRET: éš¨æ©Ÿå¯†é‘°å­—ä¸²
```

## ğŸ‘¨â€ğŸ’» é–‹ç™¼æŒ‡å—

### ğŸ› ï¸ é–‹ç™¼ç’°å¢ƒè¨­å®š
```bash
# ğŸ”§ æœ¬åœ°é–‹ç™¼æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰
cd booking_backend
docker-compose up  # æŸ¥çœ‹å³æ™‚æ—¥èªŒ

# ğŸ”„ ç¨‹å¼ç¢¼ä¿®æ”¹å¾Œé‡å•Ÿ
docker-compose restart backend

# ğŸ§¹ æ¸…ç† Docker è³‡æº
docker system prune -f
docker volume prune -f
```

### ğŸ“ ä»£ç¢¼è¦ç¯„
```yaml
å‰ç«¯æ¨™æº–:
  - Language: TypeScript 5.3+
  - Linting: ESLint + Next.js rules
  - Formatting: Prettier
  - UI: Tailwind CSS + è‡ªå®šç¾©ä¸»é¡Œ
  - Testing: Jest + React Testing Library

å¾Œç«¯æ¨™æº–:
  - Language: Python 3.11+
  - Style: PEP 8
  - Framework: Flask + Blueprint
  - Database: PostgreSQL åŸç”Ÿ SQL
  - Testing: pytest + fixtures

å®¹å™¨æ¨™æº–:
  - Multi-stage builds
  - é root ç”¨æˆ¶åŸ·è¡Œ
  - å¥åº·æª¢æŸ¥é…ç½®
  - è³‡æºé™åˆ¶è¨­å®š
```

### ğŸ”„ Git å·¥ä½œæµç¨‹
```yaml
åˆ†æ”¯ç­–ç•¥:
  - main: ç©©å®šç‰ˆæœ¬
  - develop: é–‹ç™¼åˆ†æ”¯
  - feature/*: åŠŸèƒ½åˆ†æ”¯
  - hotfix/*: ç·Šæ€¥ä¿®å¾©

æäº¤è¦ç¯„:
  - feat: æ–°å¢åŠŸèƒ½
  - fix: ä¿®å¾©éŒ¯èª¤
  - docs: æ–‡æª”æ›´æ–°
  - style: ä»£ç¢¼æ ¼å¼
  - refactor: é‡æ§‹ä»£ç¢¼
  - perf: æ€§èƒ½å„ªåŒ–
  - test: æ¸¬è©¦ç›¸é—œ
  - docker: å®¹å™¨é…ç½®
```

### ğŸ§ª æ¸¬è©¦ç­–ç•¥
```bash
# ğŸ”¬ å‰ç«¯æ¸¬è©¦
cd booking_fromtend
npm run test
npm run test:coverage

# ğŸ”¬ å¾Œç«¯æ¸¬è©¦
cd booking_backend
docker-compose exec backend python -m pytest

# ğŸ”¬ ç«¯åˆ°ç«¯æ¸¬è©¦
npm run test:e2e
```

## ğŸ”§ ç–‘é›£æ’è§£

### ğŸ³ Docker å¸¸è¦‹å•é¡Œ
```yaml
å®¹å™¨å•Ÿå‹•å¤±æ•—:
  ç—‡ç‹€: docker-compose up å¤±æ•—
  æª¢æŸ¥: docker-compose logs [service_name]
  è§£æ±º: æª¢æŸ¥ç’°å¢ƒè®Šæ•¸ã€ç«¯å£è¡çªã€æ˜ åƒææ¯€
  
ç«¯å£è¡çª:
  ç—‡ç‹€: "port already in use"
  æª¢æŸ¥: netstat -tulpn | grep :3000
  è§£æ±º: åœæ­¢ä½”ç”¨ç«¯å£çš„ç¨‹åºæˆ–ä¿®æ”¹ docker-compose.yml
  
è³‡æ–™åº«é€£ç·šå¤±æ•—:
  ç—‡ç‹€: ç„¡æ³•é€£æ¥ PostgreSQL
  æª¢æŸ¥: docker-compose ps db
  è§£æ±º: ç¢ºèªå®¹å™¨ç‹€æ…‹ã€ç’°å¢ƒè®Šæ•¸ã€ç¶²è·¯é€£é€šæ€§
  
å‰ç«¯å»ºæ§‹éŒ¯èª¤:
  ç—‡ç‹€: Next.js å»ºæ§‹å¤±æ•—
  æª¢æŸ¥: docker-compose logs frontend
  è§£æ±º: æ¸…é™¤å¿«å–ã€é‡æ–°å»ºæ§‹æ˜ åƒ
```

### ğŸ› ï¸ å¸¸ç”¨ä¿®å¾©æŒ‡ä»¤
```bash
# ğŸ”„ å®Œå…¨é‡ç½®ç’°å¢ƒ
docker-compose down -v
docker system prune -a -f
docker-compose up -d

# ğŸ—„ï¸ ä¿®å¾©è³‡æ–™åº«æ¬Šé™
sudo chown -R 999:999 booking_backend/pgdata

# ğŸ“¦ æ¸…é™¤ Node.js å¿«å–
cd booking_fromtend
rm -rf node_modules package-lock.json
docker-compose build --no-cache

# ğŸ” æª¢æŸ¥æœå‹™å¥åº·ç‹€æ…‹
docker-compose ps
docker stats --no-stream
```

### âš¡ æ•ˆèƒ½èª¿å„ªå»ºè­°
```yaml
å®¹å™¨è³‡æºé™åˆ¶:
  - å‰ç«¯: è¨˜æ†¶é«” 512MBï¼ŒCPU 0.5æ ¸
  - å¾Œç«¯: è¨˜æ†¶é«” 1GBï¼ŒCPU 1æ ¸  
  - è³‡æ–™åº«: è¨˜æ†¶é«” 2GBï¼ŒCPU 1æ ¸

ç³»çµ±å„ªåŒ–:
  - å®šæœŸæ¸…ç† Docker æ˜ åƒå’Œå®¹å™¨
  - ç›£æ§ç£ç¢Ÿç©ºé–“ä½¿ç”¨é‡
  - è¨­å®š PostgreSQL åƒæ•¸èª¿æ ¡
  - å•Ÿç”¨æ‡‰ç”¨ç¨‹å¼å¿«å–æ©Ÿåˆ¶
```

## ğŸ“ æŠ€è¡“æ”¯æ´

### ğŸ†˜ ç²å–å”åŠ©
```yaml
å•é¡Œå›å ±æµç¨‹:
  1. ğŸ“– æŸ¥é–±æœ¬æ–‡æª”ç–‘é›£æ’è§£ç« ç¯€
  2. ğŸ” æœå°‹æ—¢æœ‰ Issues æ˜¯å¦æœ‰ç›¸ä¼¼å•é¡Œ
  3. ğŸ“Š æ”¶é›†ç³»çµ±è³‡è¨Šå’ŒéŒ¯èª¤æ—¥èªŒ
  4. ğŸ“ å»ºç«‹è©³ç´°çš„å•é¡Œå ±å‘Š
  5. ğŸ·ï¸ æ¨™è¨˜é©ç•¶çš„æ¨™ç±¤

å¿…è¦è³‡è¨Š:
  - ä½œæ¥­ç³»çµ±ç‰ˆæœ¬
  - Docker/Docker Compose ç‰ˆæœ¬
  - éŒ¯èª¤è¨Šæ¯å®Œæ•´å…§å®¹
  - ç›¸é—œçš„ docker-compose logs
  - é‡ç¾å•é¡Œçš„æ­¥é©Ÿ
```

### ğŸ¤ è²¢ç»æŒ‡å—
æ­¡è¿æäº¤ Pull Request æ”¹å–„æœ¬å°ˆæ¡ˆï¼è«‹éµå¾ªï¼š
1. Fork å°ˆæ¡ˆä¸¦å»ºç«‹åŠŸèƒ½åˆ†æ”¯
2. éµå¾ªä»£ç¢¼è¦ç¯„å’Œæ¸¬è©¦æ¨™æº–
3. æ’°å¯«æ¸…æ¥šçš„æäº¤è¨Šæ¯
4. æ›´æ–°ç›¸é—œæ–‡æª”
5. æäº¤å‰ç¢ºä¿æ‰€æœ‰æ¸¬è©¦é€šé

---

## ğŸ“š å°ˆæ¡ˆè³‡è¨Š

**ğŸ« é–‹ç™¼å–®ä½**: èˆˆè¶£  
**ğŸ¯ å°ˆæ¡ˆç›®æ¨™**: æ™ºèƒ½åŒ–è¨­å‚™é ç´„ç®¡ç†å¹³å°  
**âš–ï¸ æˆæ¬Šæ¢æ¬¾**: MIT License  
**ğŸ“Š å°ˆæ¡ˆè¦æ¨¡**: 15+ è³‡æ–™è¡¨ã€50+ API ç«¯é»ã€4000+ è¡Œç¨‹å¼ç¢¼  

**ğŸ“ˆ ç³»çµ±ç‰ˆæœ¬**: v2.0  
**ğŸ“… æœ€å¾Œæ›´æ–°**: 2025å¹´06æœˆ  
**ğŸ› ï¸ éƒ¨ç½²æ–¹å¼**: Docker Compose å®¹å™¨åŒ–éƒ¨ç½²  

### ğŸ† æŠ€è¡“äº®é»
- âœ… å¾®æœå‹™æ¶æ§‹è¨­è¨ˆ
- âœ… å®Œæ•´çš„ Docker å®¹å™¨åŒ–
- âœ… PostgreSQL é«˜æ€§èƒ½è³‡æ–™åº«
- âœ… NextAuth.js å®‰å…¨èªè­‰
- âœ… éŸ¿æ‡‰å¼ UI è¨­è¨ˆ
- âœ… å³æ™‚è¡çªæª¢æ¸¬
- âœ… åŒ¿ååŒ–éš±ç§ä¿è­·
- âœ… å®Œæ•´çš„å¯©è¨ˆæ—¥èªŒ
 
